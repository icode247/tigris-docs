import NextjsGuidesSection from "@site/src/components/NextjsGuidesSection";
import createNextAppOutput from "!!raw-loader!./_createNextAppOutput";
import runNextAppOutput from "!!raw-loader!./_runNextAppOutput";
import tigrisCreateAppOutput from "!!raw-loader!./_tigrisCreateAppOutput";
import CodeBlock from "@theme/CodeBlock";
import TerminalWindow from "@site/src/components/TerminalWindow/index";
import Installation from "../../includes/_install_cloud_login.mdx";

# Tigris and Next.js

Tigris is the scalable real-time backend for Next.js applications. Build
data-rich features, seamlessly implement search, and easily connect
serverless functions.

## Getting started

<Installation />

### Initialize your Next.js app

Next.js allows you to bootstrap apps using [create-next-app](https://nextjs.org/docs/api-reference/create-next-app)
utility

```shell
npx create-next-app --example with-tigris
```

<details>
  <summary>Output</summary>
  <TerminalWindow>
    <CodeBlock language="shell">{createNextAppOutput}</CodeBlock>
  </TerminalWindow>
</details>

### Add the Tigris cloud credentials

Our application requires credentials to be able to use Tigris. Let's generate the credentials and
add them to the environment file.

#### Generating application credentials

```shell
tigris create application starter-todo-app "Starter todo application"
```

This command will create the credentials and print it on the terminal screen

```mdx-code-block
<TerminalWindow>
<CodeBlock language="shell">{tigrisCreateAppOutput}</CodeBlock>
</TerminalWindow>
```

We will use the `id` and `secret` from the output and add them as `TIGRIS_CLIENT_ID` and `TIGRIS_CLIENT_SECRET`
respectively in the file `.env.development.local` in `my-tigris-app` directory.

```shell
cd my-tigris-app
```

Now, let's create the environment file `.env.development.local` and add the application credentials generated above to it

```dotenv title=.env.development.local
TIGRIS_URI=api.preview.tigrisdata.cloud
TIGRIS_CLIENT_ID=client_id_here
TIGRIS_CLIENT_SECRET=client_secret_here
```

### Defining the data model{#data-model}

Tigris stores data records as documents. Documents are analogous to JSON objects grouped together in
a [Collection](/overview/databases). Our to-do list app has a single collection `todoItems` that
stores to-do items as documents.

This to-do app follows a convention of having models and schemas in `models/tigris` directory. Within
the directory we have `todoStarterApp` directory that will be our database name and the file
`todoItems.ts` describes the schema for collection named `todoItems`.

Let's add following highlighted code to `models/tigris/todoStarterApp/todoItems.ts`:

```ts title=models/tigris/todoStarterApp/todoItems.ts
import {
  TigrisCollectionType,
  TigrisDataTypes,
  TigrisSchema,
} from "@tigrisdata/core/dist/types";

export const COLLECTION_NAME = "todoItems";

// highlight-start
export interface TodoItem extends TigrisCollectionType {
  id?: number;
  text: string;
  completed: boolean;
}

export const TodoItemSchema: TigrisSchema<TodoItem> = {
  id: {
    type: TigrisDataTypes.INT32,
    primary_key: { order: 1, autoGenerate: true },
  },
  text: { type: TigrisDataTypes.STRING },
  completed: { type: TigrisDataTypes.BOOLEAN },
};
// highlight-end
```

We defined a data model named `TodoItem` to use in our application and created `TodoItemSchema` as a
`TigrisSchema` for the data model. In the next section we show how these data models are used to
automatically define databases and collections, and how the schemas are kept in sync with the models.


### Run

Run the app and see it automatically create your databases and collections

```shell
npm run dev
```

<details>
  <summary>Output</summary>
  <TerminalWindow>
    <CodeBlock language="shell">{runNextAppOutput}</CodeBlock>
  </TerminalWindow>
</details>

:tada: Your fullstack webapp is ready and accessible on `localhost:3000` in the browser.

## Guides

Here you will find a set of guides to help you easily build a dynamic data-rich
Next.js app with Tigris.

<NextjsGuidesSection className="two-cols" />
